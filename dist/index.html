<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>📊 进度追踪器</title>
  <!-- 引入CSS文件夹下的styles.css -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <div class="top-btn-row">
      <button id="calendar-settings-btn">📅 休假设置</button>
    </div>
    
    <h1>📊 进度追踪器</h1>

    <label for="start-date">起始日期：</label>
    <input type="date" id="start-date" />

    <label for="monthly-value">月度基准值：</label>
    <input type="number" id="monthly-value" placeholder="例如：10000" min="0" step="0.01" />

    <label for="monthly-cost">月度基础消耗：</label>
    <input type="number" id="monthly-cost" placeholder="可选，如：2000" min="0" step="0.01" value="0" />

    <label for="extra-deduction">临时调整项：</label>
    <input type="number" id="extra-deduction" placeholder="可选，如：500/-500" min="0" step="0.01" value="0" />

    <label for="target-value">累计目标值：</label>
    <input type="number" id="target-value" placeholder="例如：50000" min="0" step="0.01" />

    <div class="btn-row">
      <button id="checkin-btn">✅ 今日打卡</button>
      <button id="backfill-single-btn">➕ 单日补卡</button>
      <button id="backfill-range-btn">📅 批量补卡</button>
      <button id="calc-btn">🔄 计算进度</button>
    </div>

    <div id="error" class="error"></div>

    <div id="result" class="result">
      <p><strong>周期：</strong><span id="res-period"></span></p>
      <p><strong>有效记录天数：</strong><span id="res-days"></span> 天</p>
      <p><strong>总产出：</strong><span id="res-gross"></span></p>
      <p><strong>净值（扣除后）：</strong><span id="res-net"></span></p>
      <p id="res-forecast" style="margin-top:12px; padding-top:10px; border-top:1px dashed #ccc;"></p>
    </div>

    <!-- 图例说明 -->
    <div class="legend">
      <div class="legend-item"><div class="legend-color green"></div> 已打卡</div>
      <div class="legend-item"><div class="legend-color blue-border"></div> 工作日</div>
      <div class="legend-item"><div class="legend-color gray"></div> 休息日</div>
      <div class="legend-item"><div class="legend-color blue-bg"></div> 自定义工作</div>
      <div class="legend-item"><div class="legend-color orange-bg"></div> 自定义休息</div>
    </div>

    <!-- 动态生成的月度日历区域 -->
    <div id="month-calendars"></div>

    <div class="log" id="log"></div>
  </div>

  <!-- 休假设置模态窗口 -->
  <div id="calendar-settings-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>📅 休假设置</h3>
        <button class="close-btn">&times;</button>
      </div>
      
      <div class="date-picker-row">
        <label for="custom-date">日期:</label>
        <input type="date" id="custom-date" style="flex:1; padding:8px; border-radius:4px; border:1px solid #ccc;" />
      </div>
      
      <div>
        <label>设置为:</label>
        <div class="date-type-options">
          <div class="date-type-btn selected" data-type="work">工作日</div>
          <div class="date-type-btn" data-type="holiday">休息日</div>
          <div class="date-type-btn" data-type="remove">移除设置</div>
        </div>
      </div>
      
      <button id="save-custom-setting" style="background:#2196F3;color:white;width:100%;padding:10px;margin-top:15px;border-radius:6px;">保存设置</button>
              
      <div class="current-settings">
        <h4 style="margin:10px 0 5px;font-size:14px;">我的自定义设置:</h4>
        <div id="custom-settings-list">
          <!-- 动态生成 -->
        </div>
      </div>
    </div>
  </div>

  <!-- 单日补卡 -->
  <div id="single-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>➕ 单日补卡</h3>
        <button class="close-btn">&times;</button>
      </div>
      
      <label for="single-date">选择日期:</label>
      <input type="date" id="single-date" style="width:100%;padding:10px;margin:10px 0;border-radius:4px;border:1px solid #ccc;" />
      
      <div style="display:flex;gap:10px;margin-top:15px;">
        <button id="cancel-single" style="flex:1;background:#9E9E9E;color:white;padding:8px;border-radius:4px;">取消</button>
        <button id="confirm-single" style="flex:1;background:#FF9800;color:white;padding:8px;border-radius:4px;">确认</button>
      </div>
    </div>
  </div>

  <!-- 批量补卡 -->
  <div id="range-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>📅 批量补卡</h3>
        <button class="close-btn">&times;</button>
      </div>
      
      <label for="range-start">开始日期:</label>
      <input type="date" id="range-start" style="width:100%;padding:10px;margin:5px 0;border-radius:4px;border:1px solid #ccc;" />
      
      <label for="range-end">结束日期:</label>
      <input type="date" id="range-end" style="width:100%;padding:10px;margin:5px 0;border-radius:4px;border:1px solid #ccc;" />
      
      <label style="display:block;margin:10px 0 5px;">
        <input type="checkbox" id="include-weekends" /> 包含周末/节假日
      </label>
      
      <div style="display:flex;gap:10px;margin-top:15px;">
        <button id="cancel-range" style="flex:1;background:#9E9E9E;color:white;padding:8px;border-radius:4px;">取消</button>
        <button id="confirm-range" style="flex:1;background:#9C27B0;color:white;padding:8px;border-radius:4px;">批量添加</button>
      </div>
    </div>
  </div>

  <!-- 引入JS文件夹下的main.js -->
  <script src="js/main.js"></script>
</body>
</html>